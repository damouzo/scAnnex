/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Low Memory Config - For testing on systems with limited memory (laptops, WSL2)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    This configuration is designed for systems with 8-16GB total RAM.
    
    Usage: nextflow run main.nf -profile docker,laptop [other options]
    
    Note: Single-cell analysis is memory-intensive. For datasets with >10K cells,
    consider using a subset for testing or running on a compute cluster.
----------------------------------------------------------------------------------------
*/

params {
    // Override max resource limits for laptop/WSL2 systems with 16GB RAM
    max_memory = '8.GB'
    max_cpus   = 4
    max_time   = '8.h'
}

process {
    cpus   = 2
    memory = 3.GB
    time   = 4.h

    errorStrategy = { task.exitStatus in ((130..145) + 104) ? 'retry' : 'finish' }
    maxRetries    = 2
    maxErrors     = '-1'

    // Process-specific resource requirements - Optimized for 16GB RAM systems
    // Individual processes kept between 2GB-4GB to allow headroom for OS and other processes
    withLabel: 'process_single' {
        cpus   = 1
        memory = 2.GB
        time   = 2.h
    }
    withLabel: 'process_low' {
        cpus   = 2
        memory = 3.GB
        time   = 4.h
    }
    withLabel: 'process_medium' {
        cpus   = 3
        memory = 4.GB
        time   = 6.h
    }
    withLabel: 'process_high' {
        cpus   = 4
        memory = 6.GB
        time   = 12.h
    }
    withLabel: 'process_long' {
        time   = 16.h
    }
    withLabel: 'process_high_memory' {
        memory = 8.GB
    }
    withLabel: 'error_ignore' {
        errorStrategy = 'ignore'
    }
    withLabel: 'error_retry' {
        errorStrategy = 'retry'
        maxRetries    = 2
    }
}
