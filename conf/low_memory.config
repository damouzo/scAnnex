/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Low Memory Config - For testing on systems with limited memory (laptops, WSL2)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    This configuration is designed for systems with 4-8GB total RAM.
    
    Usage: nextflow run main.nf -profile docker,laptop [other options]
    
    Note: Single-cell analysis is memory-intensive. For datasets with >10K cells,
    consider using a subset for testing or running on a compute cluster.
----------------------------------------------------------------------------------------
*/

params {
    // Override max resource limits for low-memory systems
    max_memory = '2.5.GB'
    max_cpus   = 2
    max_time   = '4.h'
}

process {
    cpus   = 1
    memory = 1.5.GB
    time   = 2.h

    errorStrategy = { task.exitStatus in ((130..145) + 104) ? 'retry' : 'finish' }
    maxRetries    = 2
    maxErrors     = '-1'

    // Process-specific resource requirements - Optimized for low memory systems
    // All memory allocations kept under 2.5GB to fit within ~4GB available RAM
    withLabel: 'process_single' {
        cpus   = 1
        memory = 1.5.GB
        time   = 2.h
    }
    withLabel: 'process_low' {
        cpus   = 1
        memory = 2.GB
        time   = 4.h
    }
    withLabel: 'process_medium' {
        cpus   = 2
        memory = 2.5.GB
        time   = 6.h
    }
    withLabel: 'process_high' {
        cpus   = 2
        memory = 2.5.GB
        time   = 12.h
    }
    withLabel: 'process_long' {
        time   = 16.h
    }
    withLabel: 'process_high_memory' {
        memory = 2.5.GB
    }
    withLabel: 'error_ignore' {
        errorStrategy = 'ignore'
    }
    withLabel: 'error_retry' {
        errorStrategy = 'retry'
        maxRetries    = 2
    }
}
